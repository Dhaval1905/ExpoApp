{"ast":null,"code":"\"use strict\";var _toConsumableArray=require(\"@babel/runtime/helpers/toConsumableArray\");var _classCallCheck=require(\"@babel/runtime/helpers/classCallCheck\");var _createClass=require(\"@babel/runtime/helpers/createClass\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.TStylesMerger=exports.emptyProcessedPropsReg=void 0;var _cssProcessor=_interopRequireWildcard(require(\"@native-html/css-processor\"));var _TStyles=require(\"./TStyles\");function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!==\"function\")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!==\"object\"&&typeof obj!==\"function\"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!==\"default\"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var emptyProcessedPropsReg=new _cssProcessor.CSSProcessedProps();exports.emptyProcessedPropsReg=emptyProcessedPropsReg;function mapMixedStyleRecordToCSSProcessedPropsReg(processor,styles){var regStyles={};for(var key in styles){regStyles[key]=processor.compileStyleDeclaration(styles[key]);}return regStyles;}var TStylesMerger=function(){function TStylesMerger(config,modelRegistry,cssProcessorConfig){_classCallCheck(this,TStylesMerger);_defineProperty(this,\"processor\",void 0);_defineProperty(this,\"tagsStyles\",void 0);_defineProperty(this,\"classesStyles\",void 0);_defineProperty(this,\"idsStyles\",void 0);_defineProperty(this,\"enableCSSInlineProcessing\",void 0);_defineProperty(this,\"enableUserAgentStyles\",void 0);_defineProperty(this,\"modelRegistry\",void 0);this.processor=new _cssProcessor.default(cssProcessorConfig);this.modelRegistry=modelRegistry;this.classesStyles=mapMixedStyleRecordToCSSProcessedPropsReg(this.processor,config.classesStyles);this.tagsStyles=mapMixedStyleRecordToCSSProcessedPropsReg(this.processor,config.tagsStyles);this.idsStyles=mapMixedStyleRecordToCSSProcessedPropsReg(this.processor,config.idsStyles);this.enableCSSInlineProcessing=config.enableCSSInlineProcessing;this.enableUserAgentStyles=config.enableUserAgentStyles;}_createClass(TStylesMerger,[{key:\"compileInlineCSS\",value:function compileInlineCSS(inlineCSS){return this.processor.compileInlineCSS(inlineCSS);}},{key:\"compileStyleDeclaration\",value:function compileStyleDeclaration(styleDeclaration){return this.processor.compileStyleDeclaration(styleDeclaration);}},{key:\"buildStyles\",value:function buildStyles(inlineStyle,parentStyles,descriptor){var _this=this;var _this$tagsStyles,_this$idsStyles,_ref,_ref2,_model$getMixedUAStyl,_model$getUADerivedSt,_model$mixedUAStyles;var ownInlinePropsReg=this.enableCSSInlineProcessing&&inlineStyle?this.compileInlineCSS(inlineStyle):null;var model=descriptor.tagName?this.modelRegistry.getElementModelFromTagName(descriptor.tagName):null;var userTagOwnProps=(_this$tagsStyles=this.tagsStyles[descriptor.tagName])!==null&&_this$tagsStyles!==void 0?_this$tagsStyles:null;var userIdOwnProps=(_this$idsStyles=this.idsStyles[descriptor.id])!==null&&_this$idsStyles!==void 0?_this$idsStyles:null;var classes=descriptor.classes;var userClassesOwnPropsList=classes.map(function(c){return _this.classesStyles[c]||null;});var dynamicPropsFromAttributes=this.enableUserAgentStyles?(_ref=(_ref2=(model===null||model===void 0?void 0:(_model$getMixedUAStyl=model.getMixedUAStyles)===null||_model$getMixedUAStyl===void 0?void 0:_model$getMixedUAStyl.call(model,descriptor,descriptor.domNode))||null)!==null&&_ref2!==void 0?_ref2:model===null||model===void 0?void 0:(_model$getUADerivedSt=model.getUADerivedStyleFromAttributes)===null||_model$getUADerivedSt===void 0?void 0:_model$getUADerivedSt.call(model,descriptor.attributes,descriptor.markers))!==null&&_ref!==void 0?_ref:null:null;var userAgentTagProps=this.enableUserAgentStyles?(_model$mixedUAStyles=model===null||model===void 0?void 0:model.mixedUAStyles)!==null&&_model$mixedUAStyles!==void 0?_model$mixedUAStyles:null:null;var mergedOwnProps=emptyProcessedPropsReg.merge.apply(emptyProcessedPropsReg,[userAgentTagProps&&this.processor.compileStyleDeclaration(userAgentTagProps),dynamicPropsFromAttributes&&this.processor.compileStyleDeclaration(dynamicPropsFromAttributes),userTagOwnProps].concat(_toConsumableArray(userClassesOwnPropsList),[userIdOwnProps,ownInlinePropsReg]));return new _TStyles.TStyles(mergedOwnProps,parentStyles);}}]);return TStylesMerger;}();exports.TStylesMerger=TStylesMerger;","map":{"version":3,"names":["_cssProcessor","_interopRequireWildcard","require","_TStyles","emptyProcessedPropsReg","CSSProcessedProps","mapMixedStyleRecordToCSSProcessedPropsReg","processor","styles","regStyles","key","compileStyleDeclaration","TStylesMerger","config","modelRegistry","cssProcessorConfig","_classCallCheck","_defineProperty","default","classesStyles","tagsStyles","idsStyles","enableCSSInlineProcessing","enableUserAgentStyles","_createClass","value","compileInlineCSS","inlineCSS","styleDeclaration","buildStyles","inlineStyle","parentStyles","descriptor","_this","_this$tagsStyles","_this$idsStyles","_ref","_ref2","_model$getMixedUAStyl","_model$getUADerivedSt","_model$mixedUAStyles","ownInlinePropsReg","model","tagName","getElementModelFromTagName","userTagOwnProps","userIdOwnProps","id","classes","userClassesOwnPropsList","map","c","dynamicPropsFromAttributes","getMixedUAStyles","call","domNode","getUADerivedStyleFromAttributes","attributes","markers","userAgentTagProps","mixedUAStyles","mergedOwnProps","merge","apply","concat","_toConsumableArray","TStyles"],"sources":["/Users/dhavalpatel/Documents/ExpoApp/node_modules/react-native-render-html/node_modules/@native-html/transient-render-engine/lib/commonjs/styles/TStylesMerger.ts"],"sourcesContent":["import CSSProcessor, {\n  CSSProcessedProps,\n  CSSProcessorConfig,\n  MixedStyleDeclaration\n} from '@native-html/css-processor';\nimport HTMLModelRegistry from '../model/HTMLModelRegistry';\nimport { TNodeDescriptor } from '../tree/tree-types';\nimport { TStyles } from './TStyles';\nimport { StylesConfig } from './types';\n\nexport const emptyProcessedPropsReg: CSSProcessedProps =\n  new CSSProcessedProps();\n\nfunction mapMixedStyleRecordToCSSProcessedPropsReg(\n  processor: CSSProcessor,\n  styles?: Record<string, MixedStyleDeclaration>\n): Record<string, CSSProcessedProps> {\n  let regStyles: Record<string, CSSProcessedProps> = {};\n  for (const key in styles) {\n    regStyles[key] = processor.compileStyleDeclaration(styles[key]);\n  }\n  return regStyles;\n}\n\n// Specificity hierarchy, in descending order:\n// 1. Inline styles\n// 2. ID (idsStyles)\n// 3. Classes (classesStyles)\n// 4. Element name (tagsStyles)\n// 5. Attribute styles (styles derived from attributes)\n// 6. Default element styles\n// 7. Inherited styles (baseFontStyles)\nexport class TStylesMerger {\n  private processor: CSSProcessor;\n  private tagsStyles: Record<string, CSSProcessedProps>;\n  private classesStyles: Record<string, CSSProcessedProps>;\n  private idsStyles: Record<string, CSSProcessedProps>;\n  private enableCSSInlineProcessing: boolean;\n  private enableUserAgentStyles: boolean;\n  private modelRegistry: HTMLModelRegistry<string>;\n  constructor(\n    config: Required<StylesConfig>,\n    modelRegistry: HTMLModelRegistry<string>,\n    cssProcessorConfig?: CSSProcessorConfig\n  ) {\n    this.processor = new CSSProcessor(cssProcessorConfig);\n    this.modelRegistry = modelRegistry;\n    this.classesStyles = mapMixedStyleRecordToCSSProcessedPropsReg(\n      this.processor,\n      config.classesStyles\n    );\n    this.tagsStyles = mapMixedStyleRecordToCSSProcessedPropsReg(\n      this.processor,\n      config.tagsStyles\n    );\n    this.idsStyles = mapMixedStyleRecordToCSSProcessedPropsReg(\n      this.processor,\n      config.idsStyles\n    );\n    this.enableCSSInlineProcessing = config.enableCSSInlineProcessing;\n    this.enableUserAgentStyles = config.enableUserAgentStyles;\n  }\n\n  compileInlineCSS(inlineCSS: string) {\n    return this.processor.compileInlineCSS(inlineCSS);\n  }\n\n  compileStyleDeclaration(styleDeclaration: MixedStyleDeclaration) {\n    return this.processor.compileStyleDeclaration(styleDeclaration);\n  }\n\n  buildStyles(\n    inlineStyle: string,\n    parentStyles: TStyles | null,\n    descriptor: TNodeDescriptor\n  ): TStyles {\n    const ownInlinePropsReg =\n      this.enableCSSInlineProcessing && inlineStyle\n        ? this.compileInlineCSS(inlineStyle)\n        : null;\n    const model = descriptor.tagName\n      ? this.modelRegistry.getElementModelFromTagName(descriptor.tagName)\n      : null;\n    const userTagOwnProps =\n      this.tagsStyles[descriptor.tagName as string] ?? null;\n    const userIdOwnProps = this.idsStyles[descriptor.id as string] ?? null;\n    const classes = descriptor.classes;\n    const userClassesOwnPropsList = classes.map(\n      (c) => this.classesStyles[c] || null\n    );\n    const dynamicPropsFromAttributes = this.enableUserAgentStyles\n      ? (model?.getMixedUAStyles?.(descriptor, descriptor.domNode!) || null) ??\n        model?.getUADerivedStyleFromAttributes?.(\n          descriptor.attributes,\n          descriptor.markers\n        ) ??\n        null\n      : null;\n    const userAgentTagProps = this.enableUserAgentStyles\n      ? model?.mixedUAStyles ?? null\n      : null;\n    // Latest properties will override former properties.\n    const mergedOwnProps = emptyProcessedPropsReg.merge(\n      userAgentTagProps &&\n        this.processor.compileStyleDeclaration(userAgentTagProps),\n      dynamicPropsFromAttributes &&\n        this.processor.compileStyleDeclaration(dynamicPropsFromAttributes),\n      userTagOwnProps,\n      ...userClassesOwnPropsList,\n      userIdOwnProps,\n      ownInlinePropsReg\n    );\n    return new TStyles(mergedOwnProps, parentStyles);\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}